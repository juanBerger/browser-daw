{"version":3,"file":"app.js","sources":["../node_modules/svelte/store/index.mjs","../src/utils.js","../omt:/Users/juanaboites/browser-daw/src/awp.js","../src/audio-utils.js","../src/stores.js","../src/Clip.svelte","../src/Track.svelte","../src/TrackArea.svelte","../src/LeftArea.svelte","../src/Header.svelte","../src/app.js"],"sourcesContent":["import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = new Set();\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (const subscriber of subscribers) {\n                    subscriber[1]();\n                    subscriber_queue.push(subscriber, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.add(subscriber);\n        if (subscribers.size === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            subscribers.delete(subscriber);\n            if (subscribers.size === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","//(span of new range * real current delta / span of old range) + newRangeMin\nexport const scaler = (value, oldMin, oldMax, newMin, newMax) => {\n    return (newMax - newMin) * (value - oldMin) / (oldMax - oldMin) + newMin\n}\n\n//http://www.topherlee.com/software/pcm-tut-wavformat.htmlx\n\nexport function uuidv4() {\n    return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c => \n        (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16));\n}","export default import.meta.ROLLUP_FILE_URL_5d472217;","import awpURL from 'omt:./awp.js'\n\nexport const AudioCore = {\n\n    audioContext: null,\n    awp: null,\n    totalSamples: 0,\n    onMessageCallbacks: [],\n    addFileResult: -1,\n    getWaveFormResult: -1,\n\n    registerCallback(callback){\n        this.onMessageCallbacks.push(callback)\n    },\n\n    initOnMessage(){\n        this.awp.port.onmessage = e => {\n            \n            //special cases\n            if (e.data.id){\n                this.addFileResult = e.data.id;\n                return\n            }\n\n            else if (e.data.setWaveform){\n                this.getWaveFormResult = e.data.setWaveform;\n                return\n            }\n            \n            this.onMessageCallbacks.forEach(cb => cb(e))\n        }\n    },\n\n    addFile (arrayBuffer, filename) {\n        \n        return new Promise((resolve, reject) => {\n            \n            const interval = setInterval(() => {\n                \n                if(this.addFileResult !== -1){\n                    clearInterval(interval);\n                    let result = this.addFileResult\n                    this.addFileResult = - 1;\n                    this.addFileResult !== null ? resolve(result) : reject(result);\n                }\n            \n            }, 3)\n            \n            this.awp.port.postMessage({file: arrayBuffer, filename: filename}, [arrayBuffer])\n        })\n    },\n\n\n    getWaveform (id){\n        return new Promise((resolve, reject) => {\n            \n            const interval = setInterval(() => {\n    \n                if(this.getWaveFormResult !== -1){\n                    clearInterval(interval);\n                    let result = this.getWaveFormResult;\n                    this.getWaveFormResult = -1;\n                    this.getWaveFormResult !== null ? resolve(result) : reject(result);\n                }\n            \n            }, 3)\n            \n        \n            this.awp.port.postMessage({getWaveform: id})\n            \n        })\n\n    },\n\n    addClips (){\n\n    },\n\n    async create() {\n\n        this.audioContext = new AudioContext({latencyHint: 0, sampleRate: 48000});\n        console.log(this.audioContext.audioWorklet)\n        await this.audioContext.audioWorklet.addModule(awpURL)\n        this.awp = new AudioWorkletNode(this.audioContext, 'awp', {numberOfInputs: [1], numberOfOutputs: [1], outputChannelCount: [2]});\n        this.awp.connect(this.audioContext.destination);\n        console.log('Created Audio Context: ', this.audioContext);\n        this.initOnMessage();\n        return Promise.resolve();\n    }\n\n\n}\n\n\nexport function convolve(inline){\n    let x = [0, 1.3, 3.3, 4.5, 6.6, 23]\n    let h = [1, 1, 0.6, 2]\n\n    if (inline){\n        let y = Array(x.length + h.length - 1).fill(0)\n        for (let i=0; i < x.length; i++){\n            for (let j=0; j < h.length; j++){\n                y[i + j] += x[i] * h[j]\n            } \n        }\n\n        return y\n    }\n    \n    else {\n        let outputs = []\n        for (let i=0; i < x.length; i++){\n            let output = Array(x.length + h.length - 1).fill(0)\n            for (let j=0; j < h.length; j++){\n                output[i + j] += x[i] * h[j]\n            }\n            \n            outputs.push(output)\n        }\n\n        return outputs\n    }\n\n}","import { writable } from 'svelte/store'\nimport { scaler } from './utils.js'\n\nimport { AudioCore } from './audio-utils.js'\n\nconst MIN_FPP = 25; \nconst MAX_FPP = 10000;\nconst CHANNELS = 2;\n\nfunction applyEasing (x) {\n    const { set, update, subscribe } = writable(x);\n    return {\n        set,\n        update, \n        ease: (x) => {\n           \n            //x *= 0.1\n            //let eased = -(Math.cos(Math.PI * x) - 1) / 2\n            //let eased = x < 0.5 ? 16 * x * x * x * x * x : 1 - Math.pow(-2 * x + 2, 5) / 2;\n            //this needs to get much slower as it gets closer to MIN_SPP\n            let eased = x\n            let scaled = Math.round(scaler(eased, 0, 30, MIN_FPP, MAX_FPP))\n            //scaled % CHANNELS === 0 ? scaled = scaled : scaled += scaled \n            scaled /= CHANNELS\n            console.log('[CURRENT FPP]...', scaled)\n            set(scaled)\n            \n        },\n        subscribe\n    }\n}\n\nexport const framesPerPixel = applyEasing();\n\nexport const currentFrame = writable(0);\nexport const isPlaying = writable(false);\n\nconst unsub = currentFrame.subscribe(frame => {\n    if (AudioCore.awp){\n        AudioCore.awp.port.postMessage({snap: frame})\n    }\n});\n\nAudioCore.registerCallback(e => {\n    if (e.data.tick) currentFrame.set(e.data.tick)\n});\n","\n<script>\n\nimport { onMount } from 'svelte';\nimport { get } from 'svelte/store';\nimport {framesPerPixel} from './stores';\n\nimport { uuidv4 } from './utils.js';\nimport Clip from './Clip.svelte'\n\nimport Line from './Line.svelte'\nimport { AudioCore } from './audio-utils.js'\n\nexport let parent; //track div\nexport let fileId; //what is the backing audio file id\nexport let trackId; //this gets added to the metas\nexport let start; //start position on the timeline in pixels\nexport let clipTrims; //left and right trims in samples\n\n//exposed in markup\nlet clipId;\nlet lineData;\nlet _clip;\nlet _mask;\nlet _points = '';\nlet _vbLength = 0; //the polyline creates a new point at each pixel\nlet _vbHeight = 0;\nlet _vbShift = '0';\nlet _maxSvgWidth = 0;\nlet lineWidth = 0; //this has to translate line space\n\n//let clipId;\n//let lineTrims = [0, 0];\nlet hasLoaded = false;\n\n/* Mouse states */\nlet mouse = null;\nlet mouseDown = false;\nlet mouseUp = false;\n\n/* Actions */\nlet isTrimming = false;\nlet isMoving = false;\nlet isHighlighting = false;\nlet firstHighlight = true;\n\nlet hlStart = 0;\nlet hlEnd = 0;\nlet lastfpp = null;\n\n\nconst unsub = framesPerPixel.subscribe(fpp => {\n    const zoom = () => {\n\n        updateClipWidth(clipTrims, lineData, fpp);\n        \n        let prevPosFrames = pixelsToFrames(start, lastfpp);\n        let newPosPixels = framesToPixels([prevPosFrames], fpp)\n        let delta = newPosPixels - start; //should be negative when we zoom out\n        start = updatePosition(delta, start);\n        _maxSvgWidth = Number(window.getComputedStyle(_clip).getPropertyValue('--width').split('px')[0]);\n        lastfpp = fpp;\n    }\n    \n    //skip the zoom operation when the fpp is initially set on load\n    !lastfpp ? lastfpp = fpp : zoom();\n});\n\n\nconst setVerticalPointers = (e) => {\n    let pointerType;\n    if (mouse){\n        if (e.offsetY > _clip.offsetHeight / 2){ \n            _clip.style.setProperty('--cursor', 'grab')\n            pointerType = 'grab'\n        }\n        else {\n            pointerType = 'text'\n            _clip.style.setProperty('--cursor', 'text')\n        }\n    }\n    return pointerType\n}\n\nconst highlightHandler = e => {\n    \n    if (firstHighlight){\n        _mask.style.setProperty('--opacity', 0.3)\n        firstHighlight = false;\n        hlStart = e.offsetX\n        hlEnd = hlStart\n        _mask.style.setProperty('--position', String(hlStart) + 'px')\n        return\n    }\n    \n    hlEnd += e.movementX\n    let delta = Math.abs(hlEnd - hlStart)\n    if (hlEnd < hlStart){\n        _mask.style.setProperty('--position', String(hlStart - delta) + 'px')\n    }\n\n    _mask.style.setProperty('--width', String(delta) + 'px')\n}\n\n\n// const clipWidth = (lineData, clipTrims, spp) => {\n//     let sampleWidth = lineData.sampleLength - (clipTrims[0] + clipTrims[1]);\n//     let pixelWidth = (sampleWidth / spp) / lineData.channels\n//     return Math.round(pixelWidth)\n// }\n\n// const setClipSize = (lineData, spp) => {\n//     let audioFrames = (lineData.points.length * lineData.density) / lineData.channels\n//     return Math.round(audioFrames / spp)\n// }\n\n\n// const zoomClips = fpp => {\n//     let sampleLength = (lineTrims[1] - lineTrims[0]) * lineData.density\n//     return Math.round((sampleLength / spp) / lineData.channels)\n// }\n\n\n/**\n * \n * @param pixels\n * @param fpp\n * @param lineData\n */\nconst pixelsToLinePoints = (pixels, fpp, lineData) => {\n    let frames = pixels * fpp\n    return Math.round(frames / (lineData.density / lineData.channels));\n}\n\n/**\n * \n * @param pixelChange : Positive to the right, negative to the left.\n * @param start: &start position in pixels. Updates this global var in place\n */\n const updatePosition = (pixelChange, start) => {\n    start += pixelChange\n    _clip.style.setProperty('--position', start + 'px')\n    return start\n}\n\n\nconst updateWaveform = (lineTrims, lineData) => {\n    const subArray = lineData.points.slice(lineTrims[0], (lineData.points.length - lineTrims[1]));\n    _vbLength = String(subArray.length)\n    _points = subArray.join(' ');\n}\n\n\nconst updateClipWidth = (clipTrims, lineData, fpp) => {\n    let totalWidth = (lineData.sampleLength / lineData.channels) - (clipTrims[0] + clipTrims[1]);\n    totalWidth /= fpp;\n    _clip.style.setProperty('--width', String(Math.round(totalWidth)) + 'px');\n}\n\n\nconst clipTrimsToLineTrims = (clipChange, lineData) => {\n    return clipChange.map(c => (\n        (c / (lineData.density / lineData.channels))\n    ))\n}\n\n\n/**\n * frames to pixels - \n * @param frames - array to sum. This is so that we can easily use with trims\n * @param fpp - current frames per pixel value\n */\nconst framesToPixels = (frames, fpp) => {\n    const totalFrames = frames.reduce((prev, current) => prev + current);\n    return Math.round(totalFrames / fpp);\n}\n\nconst pixelsToFrames = (pixels, fpp) => {\n    return Math.round(pixels * fpp);\n}\n\nconst setCoreTrims = (clipTrims, fileId, clipId, position, trackId) => {\n    //clipTrims[0] -= 12000 //everything is a little off lol \n    //clipTrims = clipTrims.map(ct => ct * 1);\n    AudioCore.awp.port.postMessage({trims: {fileId: fileId, clipId: clipId, trackId: trackId, meta: [position * get(framesPerPixel), clipTrims[0], clipTrims[1]]}})\n}\n\nconst updateTrims = (pixelChange, side, clipTrims, lineTrims, lineData) => {\n\n    // console.log(pixelChange)\n    // if (pixelChange !== 0){\n    //     pixelChange = 1;\n    //     console.log(pixelChange)\n    // }    \n    \n\n    if (side === 'left'){\n        let lNewClipTrim = clipTrims[0] + pixelsToFrames(pixelChange, get(framesPerPixel));\n        if (lNewClipTrim < 0) return;\n        clipTrims[0] = lNewClipTrim;\n        start += pixelChange;\n        \n        let lNewLineTrim = lineTrims[0] + pixelsToLinePoints(pixelChange, get(framesPerPixel), lineData);\n        if (lNewLineTrim < 0) return;\n        lineTrims[0] = lNewLineTrim\n        _vbShift = String(Number(lineTrims[0]));  //Need to move the viewbox a commesurate amount\n    }\n    \n    //for actual trimming pixel change will be negative\n    else if (side === 'right'){\n        pixelChange *= -1;``\n        let rNewClipTrim = clipTrims[1] + pixelsToFrames(pixelChange, get(framesPerPixel));\n        if (rNewClipTrim < 0) return;\n        clipTrims[1] = rNewClipTrim\n        \n        let rNewLineTrim = lineTrims[1] + pixelsToLinePoints(pixelChange, get(framesPerPixel), lineData);\n        if (rNewLineTrim < 0) return;\n        lineTrims[1] = rNewLineTrim;\n    }\n\n    updateClipWidth(clipTrims, lineData, get(framesPerPixel));\n    updateWaveform(lineTrims, lineData);\n    start = updatePosition(0, start); //pixelChange is 0 here since this is the first call\n    setCoreTrims(clipTrims, fileId, clipId, start, trackId); \n\n}\n\nconst clearCore = (fileId, clipId) => {\n    AudioCore.awp.port.postMessage({clear: {fileId: fileId, clipId: clipId}});\n}\n\n\nonMount(async () => {\n    \n    if (fileId !== null){\n        \n        clipId = uuidv4();\n        lineData = await AudioCore.getWaveform(fileId); //get waveform from back end\n\n        console.log(lineData)\n\n        _vbHeight = String(lineData.height); //an arbitrary nmber of pixels since height is scaled to conatiner box. Higher values create lighter looking lines\n        _vbLength = String(lineData.points.length); //this is really already in pixel space because each point increments by one pixel (its 1px per 'density' number of samples)\n        _maxSvgWidth = framesToPixels([lineData.sampleLength / lineData.channels], get(framesPerPixel));\n\n        \n        let lineTrims = clipTrimsToLineTrims(clipTrims, lineData);\n        updateTrims(0, 'left', clipTrims, lineTrims, lineData);\n        updateTrims(0, 'right', clipTrims, lineTrims, lineData);\n            \n        //* MOUSE *//\n        window.addEventListener('mousedown', e => {\n            //reset any highlights\n            // _mask.style.setProperty('--opacity', 0);\n            // _mask.style.setProperty('--position', String(hlStart) + 'px');\n            // _mask.style.setProperty('--width', '0px');\n            // hlStart = 0;\n            // hlEnd = 0;\n\n        })\n\n\n        window.addEventListener('keydown', e => {\n            \n            if(e.key === 'Backspace' && (Math.abs(hlStart - hlEnd) > 0)){\n\n                const rOffset = Number(window.getComputedStyle(_clip).getPropertyValue('--width').split('px')[0]) - hlStart\n                const lClipTrims = [clipTrims[0], clipTrims[1] + pixelsToFrames(rOffset, get(framesPerPixel))]\n     \n                const lOffset = hlStart + (hlEnd - hlStart);\n                const rClipTrims = [clipTrims[0] + pixelsToFrames(lOffset, get(framesPerPixel)) , clipTrims[1]]\n\n                parent.removeChild(_clip)\n\n                new Clip({\n                    target: parent,\n                    props: {\n                        start: start,\n                        clipTrims: lClipTrims,\n                        fileId: fileId,\n                        parent: parent\n                    }\n                })\n                \n                \n    \n                // new Clip({\n                //     target: parent,\n                //     props: {\n                //         start: start + lOffset,\n                //         clipTrims: rClipTrims,\n                //         fileId: fileId,\n                //         parent: parent\n                //     }\n                // })\n\n                unsub(); //unsubs from the fpp store\n                clearCore(fileId, clipId);\n                \n            }\n        })\n\n\n        //reset flags here since we may be outside of the clip\n        window.addEventListener('mouseup', e => {\n            \n            mouseDown = false;\n            isTrimming = false;\n            isMoving = false;\n            isHighlighting = false; //the highlight may still be visible, but it is no longer changing\n            firstHighlight = true;\n            // hlStart = 0;\n            // hlEnd = 0;\n        })\n\n        _clip.addEventListener('mouseenter', e => { mouse = true; })\n        _clip.addEventListener('mouseleave', e => { mouse = false; })\n        _clip.addEventListener('mousedown', e => mouseDown = true)\n\n        _clip.addEventListener('mouseup', e => {\n            //isTrimming isMoving etc are reset on the window version of this event listener\n            if (mouse) setVerticalPointers(e)\n        })\n        \n        _clip.addEventListener('mousemove', e => {\n\n            if (isHighlighting){\n                //highlightHandler(e);\n            \n            }\n            \n            else if (isMoving){\n                start = updatePosition(e.movementX, start);\n                setCoreTrims(clipTrims, fileId, clipId, start, trackId); \n            }\n\n            else if (isTrimming){\n                _clip.style.setProperty('--cursor', 'ew-resize');\n                e.offsetX < _clip.offsetWidth * 0.05 && updateTrims(e.movementX, 'left', clipTrims, lineTrims, lineData);\n                e.offsetX > _clip.offsetWidth * 0.95 && updateTrims(e.movementX, 'right', clipTrims, lineTrims, lineData);\n            }\n        \n            else if (e.offsetX < _clip.offsetWidth * 0.05 || e.offsetX > _clip.offsetWidth * 0.95){\n                if (e.srcElement.id != '-mask'){ //make sure we are referencing the clip\n                    _clip.style.setProperty('--cursor', 'ew-resize');\n                    if (mouseDown) isTrimming = true;\n                }\n            }\n\n            else {\n            let type = setVerticalPointers(e);\n            if (mouseDown){\n                    if (type === 'grab') isMoving = true;\n                    else if (type === 'text') isHighlighting = true;\n                }\n            }\n        })\n    \n        hasLoaded = true;\n\n    }\n    \n    else console.error('No Audio Associated With This Clip')\n})\n\n</script>\n<div bind:this={_clip} class='clip'>\n    <!-- <div bind:this={_mask} class='mask' id='-mask'></div> -->\n    <div class=\"line\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"100%\" width=\"100%\" preserveAspectRatio=\"none\" stroke-width='2' viewBox='{_vbShift} 0 {_vbLength} {_vbHeight}'>\n           <polyline stroke='white' points={_points} fill='none'/>\n        </svg>\n    </div>\n</div> \n\n<style>\n    .clip {\n        --position: 0px;\n        --cursor: auto;\n        --width: 0px;\n        /* display: grid; */\n        position: relative;\n        grid-template-rows: 100%;\n        box-shadow: 0.06em 0.06em 0.2em 0.09em rgba(163, 142, 168, 0.46);\n        height: 89%;\n        width: var(--width);\n        margin-top: auto;\n        margin-bottom: auto;\n        transform: translateX(var(--position));\n        background: rgba(177, 177, 177, 0.06);\n        cursor: var(--cursor);\n    }\n\n    .line {\n        width: 100%;\n        height: 100%;\n        /* grid-row-start: 1;\n        grid-column-start: 1; */\n        /* transform: translateX(var(--position)); */\n        /* position: absolute; */\n    }\n\n    .mask {\n        --opacity: 0;\n        --position: 0px;\n        --width: 0px;\n        width: var(--width);\n        /* transform: translateX(var(--position)); */\n        height: 100%;\n        /* grid-row-start: 1;\n        grid-column-start: 1; */\n        background: rgba(209, 213, 255, var(--opacity)); /*up to 0.2 maybe*/\n\n    }\n\n\n</style>\n\n\n    ","<script>\n\nimport { onMount } from 'svelte';\nimport Clip from './Clip.svelte'\n\nexport let parent;\nexport let fileId;\nexport let trackId;\n\nlet _this;\nlet _mouse = false;\nconst _clips = [];\n\nonMount(() => {\n    \n    if(_this){\n\n        _this.addEventListener('mouseenter', (e) => _mouse = true)\n        _this.addEventListener('mouseleave', (e) => _mouse = false)\n        \n        const clip = new Clip({\n            target: _this,\n            props: {\n                start: 10,\n                clipTrims: [0, 0], //this means full width; //144000\n                fileId: fileId,\n                trackId: trackId,\n                parent: _this,\n            }\n        })\n\n        _clips.push(clip)\n    }\n})\n\n</script>\n\n<div bind:this={_this} class='trackRow track'></div>\n\n\n\n<style>\n\n\n.trackRow.track {\n    /* height: 10%; */\n    /* display: flex; */\n    border-bottom: 1px solid rgba(249, 206, 201, 0.373);\n\n}\n\n</style>\n\n\n","<script>\n\nimport { onMount } from 'svelte';\n\n\n\n\nimport { get } from 'svelte/store'\nimport { framesPerPixel } from './stores.js'\nimport { uuidv4 } from './utils.js';\n\nimport Track from './Track.svelte'\nimport Meter from './Meter.svelte'\nimport Playhead from './Playhead.svelte'\n\nimport { AudioCore } from './audio-utils.js'\n\nexport let leftArea;\n\n//* Playhead related *//\nlet _this;\nlet _mouse = false;\nlet _zoomStep = 5; // 0 to 30 --> as this gets higher polyline height should somehow get smaller\nlet playheadHeight = 0;\n\nlet SR = 48000\nlet NUM_HOURS = 1\n\n\nconst readFile = async () => {\n    \n    const [handle] = await window.showOpenFilePicker({\n        types: [{ description: '16 bit .wav file', accept: {'application/octet-stream': ['.wav']}}],\n        startIn: 'desktop'}) \n    const file = await handle.getFile()\n    const buffer = await file.arrayBuffer()\n    return [buffer, file]\n}\n\n// window.onclick = async e => {\n    \n//     await AudioCore.create();\n// }\n\nonMount(async () => {\n\n    //S E T    M A X    W I D T H //\n    let totalSamples = SR * 60 * 60 * NUM_HOURS\n    AudioCore.totalSamples = totalSamples\n    framesPerPixel.ease(_zoomStep)\n    let pixelWidth = String(Math.round(totalSamples / get(framesPerPixel)))\n    _this.style.setProperty('--trackArea-width', pixelWidth + 'px')\n\n    framesPerPixel.ease(_zoomStep)\n    await AudioCore.create();\n\n    let file = \"test_1.wav\";\n    const req = new XMLHttpRequest();\n    req.open(\"GET\", file, true);\n    req.responseType = \"arraybuffer\";\n    req.send();\n    req.onload = async e => {\n        const audioBuffer = req.response;\n        const fileId = await AudioCore.addFile(audioBuffer, file.split('.wav')[0]);\n        if (fileId !== null) {\n            const track = new Track({\n                target: trackArea,\n                props: {\n                    fileId: fileId,\n                    trackId: uuidv4(),\n                    parent: trackArea,\n                }\n            })\n        }\n    }\n})\n\n\n\n\n</script>\n\n    <div bind:this={_this} id='trackArea'>\n        <!-- {#if _this}\n            <Playhead height={playheadHeight}/>\n        {/if} -->\n    </div>\n\n<style>\n\n#trackArea {\n    --trackArea-width: 0px;\n    position: relative;\n    grid-row-start: 3;\n    grid-column-start: 3;\n    display: flex;\n    flex-direction: column;\n    margin: 0.8em;\n    width: var(--trackArea-width);\n}\n\n</style>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","\n<script>\n\n\n</script>\n\n<div class='leftArea'/>\n\n<style>\n\n.leftArea {\n\n    grid-row-start: 3;\n    grid-column-start: 1;\n    grid-column-end: 2;\n    display: flex;\n    flex-direction: column;\n    margin-top: 0.8em;\n    margin-bottom: 0.8em;\n    margin-left: 0.3em;\n    margin-right: 0.3em;\n}\n\n    \n</style>","<script>\n\nimport {framesPerPixel, currentFrame} from './stores';\n\nimport { onMount } from \"svelte\";\nimport { get } from 'svelte/store';\n\n\nlet _this;\nlet TOTAL_PADDING = 9;\n\nonMount(e => {\n\n    _this.addEventListener('click', e => {\n        let newPos = (e.offsetX - TOTAL_PADDING) * get(framesPerPixel)\n        currentFrame.set(newPos)\n    })\n})\n\n\n</script>\n\n<div bind:this={_this} id='header'></div>\n\n\n<style>\n\n    #header {\n\n        grid-column-start: 3;\n        /* grid-column-end: 2; */\n        grid-row-start: 1;\n        grid-row-end: 2;\n\n    }\n\n</style>","import './styles.css'\nimport TrackArea from './TrackArea.svelte'\nimport LeftArea from  './LeftArea.svelte'\nimport Header from './Header.svelte'\n\nimport {convolve} from './audio-utils.js'\n\n\nwindow.onload = e => {\n\n    const app = document.getElementById('app')\n    const leftArea = new LeftArea({target: app})\n    const trackArea = new TrackArea({ target: app})\n    const header = new Header({target: app})\n}\n\n\n\n//This is for a file dialogue\n// const readFile = async () => {\n//     const [handle] = await window.showOpenFilePicker({\n//         types: [{ description: 'Pro Tools Session Files', accept: {'application/octet-stream': ['.wav']}}],\n//         startIn: 'desktop'}) \n//     const file = await handle.getFile()\n//     const buffer = await file.arrayBuffer()\n//     return buffer\n// }\n\n\n\n\n\n // //** SET TO MAX WIDTH*/\n    // let totalSamples = SR * 60 * 60 * NUM_HOURS\n    // AudioCore.totalSamples = totalSamples\n    // framesPerPixel.ease(_zoomStep)\n    // let pixelWidth = String(Math.round(totalSamples / get(framesPerPixel)))\n    // _this.style.setProperty('--trackArea-width', pixelWidth + 'px')\n    \n\n    // /** LISTEN TO THIS RESIZE */\n    // const resizeObserver = new ResizeObserver(entries => {\n    //     for (let entry of entries){ playheadHeight = entry.contentRect.height }\n    // })\n    // resizeObserver.observe(_this)\n    \n\n    // /** ZOOMING */\n    // _this.addEventListener('mouseenter', e => _mouse = true)\n    // _this.addEventListener('mouseleave', e => _mouse = false)\n    // document.addEventListener('keydown', e => {\n    //     if (e.key === 'r' || e.key === 't'){\n    //         if (e.key === 'r') _zoomStep >= 30 ? _zoomStep = _zoomStep : _zoomStep++\n    //         else _zoomStep <= 0 ? _zoomStep = _zoomStep : _zoomStep--\n    //         framesPerPixel.ease(_zoomStep)\n    //         //console.log('[ZOOMING]')\n    //     }          \n    // })\n\n\n\n\n    // //* DRAG AND DROP *//   \n    //_this.addEventListener('dragover', e => { e.preventDefault() })\n    //_this.addEventListener('drop', async e => {\n\n    //    e.preventDefault()\n\n        // let handles = Array.from(e.dataTransfer.items)\n        // .filter(handle => handle.type.includes('audio'))\n        // .map(handle => handle.getAsFileSystemHandle())\n\n        // for await (const handle of handles){\n        //     const file = await handle.getFile()\n        //     const audioBuffer = await file.arrayBuffer()\n        //     if (audioBuffer.byteLength > 0){\n\n        //         if (!AudioCore.awp) await AudioCore.create()\n                \n        //         else if (AudioCore.audioContext.state === 'suspended'){\n        //             await AudioCore.audioContext.resume()\n        //             console.log(AudioCore.audioContext.state)\n        //         }\n                \n        //         console.log(handle)\n        //         // let id = await AudioCore.addFile(audioBuffer, file.name.split('.wav')[0])\n        //         // const lineData = await AudioCore.getWaveform(id); //get waveform from back end\n        //         // console.log(lineData)\n\n\n        //         if (id !== null) {\n                    \n                    \n\n\n\n                    \n                    \n                    \n                    \n        //             //if (hovering over existing track){\n        //                 //add to that track\n        //             //}\n        //             //else:\n        //             // let trackId = uuidv4();\n        //             // const track = new Track({\n        //             //     target: _this,\n        //             //     props: {\n        //             //         fileId: id,\n        //             //         trackId: trackId,\n        //             //         parent: _this\n        //             //     }\n        //             // })\n\n        //             // let leftArea = document.getElementsByClassName('leftArea')[0];\n        //             // const meter = new Meter({\n        //             //     target: leftArea,\n        //             //     props: {\n        //             //         fileId: id,\n        //             //         trackId: trackId,\n        //             //     }\n        //             // })\n                    \n        //         }\n                \n        //     }\n        //}"],"names":["get","Clip"],"mappings":"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IAAI,MAAM,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,KAAK,EAAC;AAC9C,IAAqB,IAAI,QAAQ,CAAC,CAAC,MAAM,EAAE,GAAG,CAAC,EAAC;AAChD,IAAsB,IAAI,SAAS,CAAC,EAAE,MAAM,EAAE,GAAG,CAAC,EAAC;AACnD,IAAmB,IAAI,MAAM,CAAC,CAAC,MAAM,EAAE,GAAG,CAAC,EAAC;AAC5C,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}